From c30b9851349f7f6342aa8299e00a41f650cd8238 Mon Sep 17 00:00:00 2001
From: Charles Stevens <charles.stevens@logicpd.com>
Date: Tue, 24 Mar 2020 14:20:42 -0500
Subject: [PATCH 05/18] Ethernet Phy hack to get GigE working

---
 drivers/net/phy/at803x.c | 12 ++++++++++--
 1 file changed, 10 insertions(+), 2 deletions(-)
 mode change 100644 => 100755 drivers/net/phy/at803x.c

diff --git a/drivers/net/phy/at803x.c b/drivers/net/phy/at803x.c
old mode 100644
new mode 100755
index 411cf1072bae..5a5462a1af0b
--- a/drivers/net/phy/at803x.c
+++ b/drivers/net/phy/at803x.c
@@ -107,7 +107,11 @@ static int at803x_debug_reg_mask(struct phy_device *phydev, u16 reg,
 	val &= ~clear;
 	val |= set;
 
-	return phy_write(phydev, AT803X_DEBUG_DATA, val);
+	ret = phy_write(phydev, AT803X_DEBUG_DATA, val);
+
+	printk("CHS: reg %d val 0x%08X\n", reg, at803x_debug_reg_read(phydev, reg));
+
+	return ret;
 }
 
 static inline int at803x_enable_rx_delay(struct phy_device *phydev)
@@ -255,20 +259,24 @@ static int at803x_config_init(struct phy_device *phydev)
 	if (ret < 0)
 		return ret;
 
+printk("CHS: %s - %d\n", __FUNCTION__, __LINE__);
 	if (phydev->interface == PHY_INTERFACE_MODE_RGMII_RXID ||
 			phydev->interface == PHY_INTERFACE_MODE_RGMII_ID) {
+printk("CHS: %s - %d\n", __FUNCTION__, __LINE__);
 		ret = at803x_enable_rx_delay(phydev);
 		if (ret < 0)
 			return ret;
 	}
 
-	if (phydev->interface == PHY_INTERFACE_MODE_RGMII_TXID ||
+	if (1 || phydev->interface == PHY_INTERFACE_MODE_RGMII_TXID ||
 			phydev->interface == PHY_INTERFACE_MODE_RGMII_ID) {
+printk("CHS: %s - %d\n", __FUNCTION__, __LINE__);
 		ret = at803x_enable_tx_delay(phydev);
 		if (ret < 0)
 			return ret;
 	}
 
+printk("CHS: %s - %d\n", __FUNCTION__, __LINE__);
 	return 0;
 }
 
-- 
2.17.1

